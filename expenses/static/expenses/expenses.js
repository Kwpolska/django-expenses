!function(e){var t={};function n(a){if(t[a])return t[a].exports;var l=t[a]={i:a,l:!1,exports:{}};return e[a].call(l.exports,l,l.exports,n),l.l=!0,l.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var l in e)n.d(a,l,function(t){return e[t]}.bind(null,l));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t,n){"use strict";t.__esModule=!0,t.getNewAIDForSelector=function(e){var t=document.querySelector(e),n=parseInt(t.dataset.last_aid)+1;return t.dataset.last_aid=n.toString(),n},t.getTrForEvent=function(e){return e.target.closest("tr")}},function(e,t,n){"use strict";t.__esModule=!0;
/*!
 * Expenses Scripting Enhancements
 * Copyright © 2018, Chris Warrick. All rights reserved. License: 3-clause BSD.
 */
var a=n(2),l=n(3),r=n(4);document.addEventListener("DOMContentLoaded",function(){if(r.default(),null!==document.querySelector("#expenses-billtable-form")&&a.default(),null!==document.querySelector("#expenses-bulkcatedit-form")&&l.default(),-1!=navigator.userAgent.indexOf("ExpensesWebView")){var e=document.querySelector(".navbar-kw");e.classList.remove("static-top"),e.classList.add("fixed-top"),document.querySelector("body").style.paddingTop="50px"}},!1)},function(e,t,n){"use strict";
/*!
 * Expenses Bill Editor
 * Copyright © 2018, Chris Warrick. All rights reserved. License: 3-clause BSD.
 */t.__esModule=!0;var a=n(0),l=["expenses-billtable-serving","expenses-billtable-count","expenses-billtable-unitprice"];function r(e){return isNaN(e)?r(0):new Intl.NumberFormat("pl-PL",{style:"currency",currency:"PLN"}).format(e)}function o(e){!function(e){var t=e.getElementsByClassName("expenses-billtable-unitprice")[0],n=e.getElementsByClassName("expenses-billtable-count")[0],a=t.getElementsByTagName("input")[0],l=n.getElementsByTagName("input")[0],o=e.getElementsByClassName("expenses-billtable-amount")[0],i=parseFloat(a.value)*parseFloat(l.value);o.innerText=r(i),o.dataset.value=i.toString(),s()}(a.getTrForEvent(e))}function s(){for(var e=document.querySelectorAll("td.expenses-billtable-amount"),t=0,n=0;n<e.length;n++){var a=parseFloat(e[n].dataset.value);isNaN(a)||(t+=a)}document.querySelector(".expenses-bill-total").innerText=r(t)}function i(){document.querySelector("#expenses-billtable-savechanges").disabled=!1}function d(e){var t={edit:{classNames:"btn-info expenses-billtable-btn-edit",title:"Edit",icon:"fa-edit",callback:m},undo:{classNames:"btn-warning expenses-billtable-btn-undo",title:"Undo Changes",icon:"fa-undo",callback:f},delete:{classNames:"btn-danger expenses-billtable-btn-delete",title:"Delete",icon:"fa-trash-alt",callback:b},accept:{classNames:"btn-success expenses-billtable-btn-accept",title:"Accept",icon:"fa-check",callback:v}};return function(e){var t=document.createElement("div");return t.className="btn-group",t.setAttribute("role","group"),t.setAttribute("aria-label","Item actions"),e.forEach(function(e){var n=document.createElement("button");n.type="button",n.className="btn "+e.classNames,n.title=e.title,n.innerHTML='<i class="fa fa-fw '+e.icon+'"></i>',n.addEventListener("click",e.callback),t.appendChild(n)}),t}(e.map(function(e){return t[e]}))}function c(){document.querySelector("#expenses-billtable-addrow .expenses-billtable-product input").focus()}function u(e){var t=document.querySelector("#expenses-billtable-addrow"),n=document.createElement("tr");n.classList.add("expenses-billtable-row","table-success");var l="a"+a.getNewAIDForSelector("#expenses-billtable-form");n.dataset.id=l,p(n,t,l,"add",["edit","delete"]),t.getElementsByClassName("expenses-billtable-amount")[0].innerText=r(0),document.querySelector("#expenses-billtable tbody").insertBefore(n,t),t.querySelectorAll("input").forEach(function(e){void 0!==e.dataset.default?e.value=e.dataset.default:e.value=""}),i(),c()}function p(e,t,n,a,o){e.dataset.type=a;for(var s=t.querySelectorAll("input"),i={},c=0;c<s.length;c++){var u=s[c];if(!u.reportValidity())throw new Error("Field "+u.name+" was invalid.");var p=document.createElement("td"),m=u.parentElement;m.dataset.hasOwnProperty("orig_text")&&(p.dataset.orig_text=m.dataset.orig_text,p.dataset.orig_value=m.dataset.orig_value),p.className=u.parentElement.className;var b=document.createElement("input");b.hidden=!0,b.value=u.value;var f=u.name;-1==f.indexOf("__")?b.name=n+"__"+f:b.name=f,p.appendChild(b);var v=u.value;"expenses-billtable-unitprice"==p.className&&(v=r(parseFloat(u.value)),p.dataset.value=u.value),p.appendChild(document.createTextNode(v)),e.appendChild(p),-1!=l.indexOf(p.className)?i[u.name]=parseFloat(u.value):i[u.name]=u.value}var x=t.getElementsByClassName("expenses-billtable-amount")[0],y=document.createElement("td");y.className="expenses-billtable-amount",y.innerText=x.innerText,y.dataset.value=x.dataset.value,x.dataset.hasOwnProperty("orig_text")&&(y.dataset.orig_text=x.dataset.orig_text,y.dataset.orig_value=x.dataset.orig_value),e.appendChild(y);var E=document.createElement("td");E.className="expenses-billtable-actions",E.innerHTML="",E.appendChild(d(o)),e.appendChild(E)}function m(e){for(var t=a.getTrForEvent(e),n=document.querySelector("#expenses-billtable-addrow"),l=0;l<t.children.length;l++){var r=t.children[l];if("expenses-billtable-actions"!=r.className){var s=r.getElementsByTagName("input"),c="";c=s.length>0?s[0].value:r.dataset.value?r.dataset.value:r.innerText.trim(),r.dataset.hasOwnProperty("orig_text")||(r.dataset.orig_text=r.innerText.trim(),r.dataset.orig_value=c.trim());var u=n.querySelector("."+r.className+" input");if(null!==u){var p=u.cloneNode(),m=p.name;p.value=c,p.name=t.dataset.id+"__"+m,"count"!=m&&"unit_price"!=m||p.addEventListener("input",o),p.addEventListener("keypress",E),r.innerHTML="",r.appendChild(p)}}else r.innerHTML="",r.appendChild(d(["accept","undo"]))}i(),e.preventDefault()}function b(e){var t=a.getTrForEvent(e),n=t.dataset.id;if("add"!==t.dataset.type){var l=document.querySelector("#expenses-billtable-deletions"),r=document.createElement("input");r.hidden=!0,r.name="d__"+n,l.appendChild(r)}t.remove(),s(),i(),e.preventDefault()}function f(e){var t=a.getTrForEvent(e);t.classList.remove("table-info"),t.querySelectorAll("td").forEach(function(e){e.dataset.hasOwnProperty("orig_text")&&(e.innerText=e.dataset.orig_text,e.dataset.value=e.dataset.orig_value),"expenses-billtable-actions"==e.className&&(e.innerHTML="",e.appendChild(d(["edit","delete"])))}),s(),e.preventDefault()}function v(e){x(a.getTrForEvent(e))}function x(e){var t=e.dataset.id,n=document.createElement("tr");n.classList.add("expenses-billtable-row","table-info"),n.dataset.id=t,p(n,e,t,function(e){return"a"==e.charAt(0)}(t)?"add":"edit",["edit","undo","delete"]),e.parentElement.replaceChild(n,e)}function y(){var e=document.querySelector("#expenses-billtable-addrow").querySelectorAll("input");e.forEach(function(e){return e.disabled=!0});try{document.querySelectorAll(".expenses-billtable-btn-accept").forEach(function(e){return x(e.closest("tr"))}),document.querySelector("#expenses-billtable-form").submit()}catch(t){e.forEach(function(e){return e.disabled=!1}),event.preventDefault()}}function E(e){if(13==e.keyCode){if(e.metaKey||e.ctrlKey)y();else{var t=a.getTrForEvent(e);"expenses-billtable-addrow"===t.id?u():x(t)}return!1}}t.default=function(){var e=document.querySelector("#expenses-billtable-btn-add");e.type="button",e.addEventListener("click",u),document.querySelectorAll(".expenses-billtable-btn-edit").forEach(function(e){return e.addEventListener("click",m)}),document.querySelectorAll(".expenses-billtable-btn-delete").forEach(function(e){return e.addEventListener("click",b)}),document.querySelector("#expenses-billtable-addrow .expenses-billtable-unitprice .form-control").addEventListener("input",o),document.querySelector("#expenses-billtable-addrow .expenses-billtable-count .form-control").addEventListener("input",o),document.querySelector("#expenses-billtable-addrow .expenses-billtable-amount").innerText=r(0),document.querySelectorAll("#expenses-billtable-addrow input").forEach(function(e){return e.addEventListener("keydown",E)}),document.querySelector("#expenses-billtable-savechanges").addEventListener("click",y);var t=document.querySelector("#expenses-billtable-form");t.action="",t.dataset.last_aid="0",c()}},function(e,t,n){"use strict";
/*!
 * Expenses Bulk Category Editor
 * Copyright © 2018, Chris Warrick. All rights reserved. License: 3-clause BSD.
 */t.__esModule=!0;var a=n(0);function l(e){var t=document.querySelector("#expenses-bulkcatedit-addrow"),n=document.createElement("tr");n.classList.add("table-success");for(var l="a"+a.getNewAIDForSelector("#expenses-bulkcatedit-form"),o=t.querySelectorAll("input"),i=0;i<o.length;i++){var d=o[i];if(!d.reportValidity())throw new Error("Field "+d.name+" was invalid.");var c=document.createElement("td");c.className=d.closest("td").className;var u=d.cloneNode();u.name=u.name.replace("add_","add_"+l+"_"),u.addEventListener("keypress",s),c.appendChild(u),n.appendChild(c)}var p=document.createElement("td");p.className="expenses-bulkcatedit-actions";var m=document.createElement("btn");m.className="btn btn-danger",m.innerHTML='<i class="fa fa-fw fa-trash-alt"></i>',m.addEventListener("click",r),p.appendChild(m),n.appendChild(p),document.querySelector("#expenses-bulkcatedit-form tbody").insertBefore(n,t),o.forEach(function(e){return e.value=""})}function r(e){a.getTrForEvent(e).remove()}function o(e){document.querySelectorAll("#expenses-bulkcatedit-addrow input").forEach(function(e){return e.disabled=!0});var t=document.querySelector("#expenses-bulkcatedit-form");t.reportValidity()?t.submit():document.querySelectorAll("#expenses-bulkcatedit-addrow input").forEach(function(e){return e.disabled=!1}),null!==e&&e.preventDefault()}function s(e){if(13==e.keyCode){if("expenses-bulkcatedit-addrow"===a.getTrForEvent(e).id){var t=document.querySelector("#expenses-bulkcatedit-addrow").querySelectorAll("input");""===t[0].value&&""===t[1].value?o(null):l()}else o(null);return!1}}t.default=function(){var e=document.querySelector("#expenses-bulkcatedit-btn-add");e.type="button",e.addEventListener("click",l),document.querySelectorAll("#expenses-bulkcatedit-addrow input").forEach(function(e){e.disabled=!1,e.addEventListener("keypress",s)}),document.querySelectorAll("#expenses-bulkcatedit-addrow input").forEach(function(e){return e.addEventListener("keypress",s)});var t=document.querySelector("#expenses-bulkcatedit-btn-save");t.type="button",t.addEventListener("click",o),document.querySelector("#expenses-bulkcatedit-form").dataset.last_aid="0"}},function(e,t,n){"use strict";
/*!
 * Expenses AutoComplete registration
 * Copyright © 2018, Chris Warrick. All rights reserved. License: 3-clause BSD.
 */function a(e,t,n){var a=document.querySelector(e);if(null!==a){var l=document.createElement("datalist");null!==t&&void 0!==t||(t=a.name);var r="ac_dl_"+t.replace(".","");l.id=r,a.setAttribute("list",r),a.parentElement.appendChild(l),l.append("<option value='x'><option value='y'>"),a.addEventListener("input",function(e){var t;t="string"!=typeof n?n():n,l.innerHTML="";var r=a.value;""!==r.trim()&&(-1!==t.indexOf("?")?t+="&q="+encodeURIComponent(r):t+="?q="+encodeURIComponent(r),fetch(t).then(function(e){return e.json()}).then(function(e){1===e.length&&e[0]===r||e.forEach(function(e){var t=document.createElement("option");t.value=e,l.appendChild(t)})}))})}}t.__esModule=!0,t.default=function(){a(".expenses-addform-vendor","vendor","/expenses/api/autocomplete/expense/vendor/"),a(".expenses-billaddform-vendor","vendor","/expenses/api/autocomplete/bill/vendor/"),a(".expenses-addform-description","description",function(){var e=document.querySelector(".expenses-addform-vendor").value.trim();return 0==e.length?"/expenses/api/autocomplete/expense/description/":"/expenses/api/autocomplete/expense/description/?vendor="+encodeURIComponent(e)})}}]);